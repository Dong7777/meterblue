# 蓝牙串口桥接工具使用手册

## 一、工具简介

本工具是一个 **Windows 平台的蓝牙 ↔ 串口数据桥接程序**，用于将 **蓝牙 BLE 设备** 与 **本地串口（COM）** 进行双向透明转发。

典型应用场景：

* 蓝牙电表 / 采集器 ↔ 上位机串口软件
* BLE 模块透传 698 / 645 / 自定义协议
* 无线替代 USB‑RS485 / USB‑TTL

特点：

* 图形界面（GUI），无需命令行
* 支持 BLE 通知 → 串口
* 支持 串口 → BLE 写入
* 适合长期运行

---

## 二、运行环境要求

### 1. 操作系统

* Windows 10 / Windows 11（64 位）

### 2. 必要条件

* 电脑支持 **蓝牙 BLE**（低功耗蓝牙）
* 蓝牙设备已支持 BLE 通知和写入
* 已安装 **Microsoft Visual C++ Redistributable 2015–2022 (x64)**

> ⚠️ 注意：不支持 Windows 7

---

## 三、启动前准备（非常重要）

在启动本工具前，请务必完成以下准备工作，否则程序可能无法正常使用。

---

### 1. 使用 VSPDConfig 建立虚拟串口对（必须）

本工具通常配合 **虚拟串口对** 使用，用于：

* 本工具占用其中一个串口
* 其他上位机 / 测试软件占用另一个串口

推荐使用软件：**VSPDConfig（Virtual Serial Port Driver）**

#### 操作步骤：

1. 安装并打开 **VSPDConfig** 软件
2. 选择功能 **“Create Pair / 创建串口对”**
3. 创建一对虚拟串口，例如：

   * COM9 ↔ COM10
4. 确认串口对状态为 **Enabled / 已启用**

> 示例说明：
>
> * 本工具中配置使用 **COM9**
> * 上位机软件（如调试工具、抄表软件）使用 **COM10**

⚠️ 注意事项：

* 两个串口必须成对使用
* 不要被其他程序占用
* 虚拟串口创建完成后不要关闭 VSPDConfig

---

### 2. 蓝牙设备配对

在首次使用前，**必须先在 Windows 系统中完成蓝牙配对**：

1. 打开 Windows「设置」
2. 进入「蓝牙和设备」
3. 添加设备 → 蓝牙
4. 选择目标设备并完成配对
5. 如有 PIN 码，请输入正确 PIN

> ⚠️ 未配对直接运行程序，蓝牙可能无法连接

---

### 2. 确认串口信息

请确认：

* 串口号（如 COM3 / COM9）
* 波特率（如 9600 / 115200）
* 串口未被其他软件占用

---

## 四、界面说明

程序启动后，界面分为以下区域：

### 1. 配置区

| 参数     | 说明                 |
| ------ | ------------------ |
| 串口     | 本地串口号，如 COM9       |
| 波特率    | 串口通信波特率            |
| 蓝牙地址   | BLE 设备 MAC 地址      |
| 蓝牙 PIN | 蓝牙配对 PIN（如 111111） |

### 2. 按钮说明

* **应用配置**：保存当前输入的参数
* **启动桥接**：启动蓝牙 ↔ 串口数据转发

### 3. 日志显示区

用于显示：

* 蓝牙连接状态
* 串口打开状态
* 数据收发十六进制内容
* 错误与异常信息

---

## 五、使用步骤（标准流程）

### 步骤 1：启动程序

双击 `blueexe.exe` 启动程序。

---

### 步骤 2：配置参数

1. 输入正确的串口号
2. 输入正确的波特率
3. 输入蓝牙设备 MAC 地址
4. 输入蓝牙 PIN（如需要）
5. 点击 **「应用配置」**

---

### 步骤 3：启动桥接

点击 **「启动桥接」** 按钮。

日志区出现以下信息表示成功：

* 串口已打开
* 蓝牙已连接
* 蓝牙通知通道已建立

---

### 步骤 4：数据转发说明

* **蓝牙 → 串口**：

  * BLE 通知数据自动写入串口
* **串口 → 蓝牙**：

  * 串口接收数据后自动写入 BLE

数据均以 **十六进制形式显示在日志中**。

---

## 六、常见问题与解决方法

### 1. 程序打不开 / 双击无反应

**解决方法：**

* 请勿使用管理员身份运行
* 确认已安装 VC++ 运行库
* 使用 onedir 版本运行

---

### 2. 蓝牙连接失败

可能原因：

* 蓝牙未在 Windows 中配对
* MAC 地址填写错误
* 设备不支持 BLE

解决方法：

* 先在系统蓝牙中完成配对
* 确认设备支持 BLE

---

### 3. 串口打开失败

可能原因：

* 串口号错误
* 串口被占用

解决方法：

* 使用设备管理器确认串口号
* 关闭占用串口的软件

---

### 4. 有连接但无数据

可能原因：

* BLE UUID 不匹配
* 设备未发送通知

解决方法：

* 确认 BLE_NOTIFY_UUID / BLE_WRITE_UUID 正确
* 使用蓝牙调试工具验证特征值

---

## 七、注意事项

* 不建议频繁反复启动桥接
* 蓝牙断开后需重新启动程序
* 长时间运行建议关闭系统休眠

---

## 八、版本信息

* 工具名称：蓝牙串口桥接工具
* 运行平台：Windows 10 / 11
* 通信方式：BLE ↔ 串口

---

## 九、技术支持

如遇到无法解决的问题，请提供：

1. 操作系统版本
2. 蓝牙设备型号
3. 串口参数
4. 程序日志截图

用于进一步分析与支持。

---

**使用本工具即表示你已阅读并理解以上内容。**

祝使用顺利 👍
